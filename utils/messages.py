
import os
import json

# File paths
BASE_DIR = os.getcwd()
LANGUAGES_FILE = os.path.join(BASE_DIR, "user_languages.json")

MESSAGES = {
    'uz': {
        'start_welcome': "Assalomu alaykum! Universal Media Botga Xush Kelibsiz\n\n@universal_media_uz_bot orqali siz quyidagilarni yuklab olishingiz mumkin:\n\nâ—Instagram - post, story, reels;\nâ—YouTube - video, shorts, audio;\nâ—Tik Tok - suv belgisiz video;\nâ—Facebook - reels\nâ—VK - video;\nâ—Pinterest - rasm, video\nâ—Snapchat - rasm, video\nâ—Likee - rasm, video\nâ—Threads - rasm, video\nâ—Bigo Live - video, efir\nBoshlash uchun havola yuboring.",
        'search_searching': "ğŸ”¥ '{query}' bo'yicha top musiqalar qidirilmoqda...",
        'search_top_loading': "ğŸ”¥ Top O'zbek musiqalari qidirilmoqda...",
        'search_not_found': "Top musiqalar hozircha topilmadi.",
        'getting_info': "â³ Ma'lumot olinmoqda...",
        'search_music_searching': "ğŸ” Musiqa qidirilmoqda: {query}...",
        'nothing_found': "Hech narsa topilmadi ğŸ˜”",
        'no_favorites': "â¤ï¸ Sizda hozircha saqlangan musiqalar yo'q.",
        'favorites_header': "â¤ï¸ <b>Saqlangan musiqalar:</b>\n\n",
        'saved': "â¤ï¸ Saqlandi!",
        'already_saved': "Allaqachon mavjud!",
        'saved_msg': "âœ… Saqlandi: {title}",
        'error_no_link': "Saqlash uchun havola topilmadi.",
        'error_general': "Xatolik: {error}",
        'choose_quality': "â¤ï¸ Tanlandi: {title}\n\nSifatni tanlang:",
        'lang_choose': "ğŸ’¬ O'zgartirmoqchi bo'lgan tilni tanlang va siz tanlagan tilda bot ishlashni boshlaydi.\n\n(Interfeys tilini tanlash uchun, pastdagi tugmalardan birini bosishingiz mumkin)",
        'lang_selected': "âœ… Til o'zgartirildi: O'zbekcha ğŸ‡ºğŸ‡¿",
        'downloading': "Yuklanmoqda... 0%",
        'downloading_percent': "Yuklanmoqda... {percent} â³",
        'finished_uploading': "Yuklab bo'lindi. Jo'natilmoqda... ğŸš€",
        'video_caption': "ğŸµ <b>{title}</b>",
        'video_only_caption': "ğŸµ <b>{title}</b>",
        'btn_video': "ğŸ¬ Video",
        'btn_audio': "ğŸ§ MP3",
        'btn_save': "ğŸ’¾ Saqlash",
        'btn_download_song': "ğŸ“¥ Qo'shiqni yuklab olish",
        'btn_add_group': "â• Guruhga qo'shish â¤´ï¸",
        'btn_close': "âŒ Yopish",
        'btn_back': "ğŸ”™ Orqaga",
        'voice_listening': "ğŸ¤ Ovozli xabar eshitilmoqda...",
        'voice_you_said': "ğŸ—£ Siz dedingiz: {text}",
        'voice_error': "ğŸ¤·â€â™‚ï¸ Uzr, nima deganingizni tushunmadim.",
        'file_too_large': "âš ï¸ Fayl hajmi juda katta ({size} MB). Telegram limiti 50 MB.\nIltimos, pastroq sifatni tanlang yoki boshqa havola yuboring.",
        'retry_low_quality': "âš ï¸ Fayl hajmi juda katta. Kichikroq sifatda qayta yuklanmoqda ({quality}p)... ğŸ“‰",
        'video_quality_select': "ğŸ¬ Video sifatini tanlang:",
        'results_title': "ğŸ” Natijalar ({page}/{total}):\n\n",
        'download_error': "Yuklanmadi ğŸ˜¢",
        'search_results_expired': "Qidiruv natijalari eskirgan.",
        'error_item_not_found': "Xatolik: Element topilmadi",
        'error_link_expired': "Xatolik yuz berdi. Iltimos, qaytadan link yuboring.",
        'voice_convert_error': "âš ï¸ Ovoz formatini o'zgartirishda xatolik.\nFFmpeg o'rnatilganligini tekshiring.",
        'voice_google_error': "âš ï¸ Google Speech xizmatida xatolik: {error}",
        'menu_tg_anon': "Telegramda yashirincha ğŸ‘€",
        'menu_insta_anon': "Instagramda yashirincha ğŸ‘€",
        'feature_soon': "ğŸ›  Bu funksiya tez orada ishga tushadi!",
        'insta_anon_instruction': "Instagram story havolasini yuboring.",
        'tg_anon_instruction': "Kimning telegramdagi hikoyasini yashirincha ko'rmoqchisiz?\nFoydalanuvchi nomi yoki kontaktini yuboring.",
        'btn_video_manual': "Video qo'llanma ğŸ·",
        'story_menu_today': "ğŸ‘€ Bugungi hikoyalarni ko'rish",
        'story_menu_old': "ğŸ‘€ Eski hikoyalarni ko'rish",
        'btn_8d': "ğŸ§ 8D",
        'btn_concert': "ğŸŸ Concert Hall",
        'btn_slowed': "ğŸ¢ Slowed",
        'btn_bass': "ğŸ”Š Bass",
        'select_effect': "Iltimos, o'zingizga kerakli variantni tanlang ğŸ‘‡",
        'recognition_processing': "ğŸ§ Media tahlil qilinmoqda... (Music Recognition)",
        'music_recognized': "ğŸµ <b>Musiqa aniqlandi!</b>\n\n",
        'music_artist': "ğŸ¤ Ijrochi: <b>{artist}</b>\n",
        'music_title': "ğŸ¼ Nomi: <b>{title}</b>\n",
        'music_not_found': "Musiqa aniqlanmadi (No music found).",
        'music_fallback_search': "âš ï¸ Musiqa aniqlanmadi. Fayl nomi bo'yicha qidirilmoqda: {query}",
        'music_fallback_failed': "Musiqa aniqlanmadi va qidiruv natija bermadi.",
        'btn_more_links': "Ko'proq havolalar ğŸ”—",
        'btn_telegram_search': "ğŸ“¥ Telegram",
        'top_menu_text': "ğŸµ <b>Top Musiqalar Bo'limi</b>\n\nQaysi turdagi musiqalarni qidirmoqchisiz?",
        'cat_uz': "ğŸ‡ºğŸ‡¿ O'zbek Xitlari",
        'cat_world': "ğŸŒ Jahon Xitlari",
        'cat_trend': "ğŸ”¥ Trend (TikTok/Reels)",
        'cat_new': "ğŸ†• Yangi Chiqqanlar",
        'cat_bass': "ğŸ”Š Bass / Avto",
        'btn_find_music': "Musiqani aniqlash ğŸ”",
        'download_formats': "Yuklab olish formatlari â†“"
    },
    'ru': {
        'start_welcome': "Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Universal Media Bot\n\nĞ§ĞµÑ€ĞµĞ· @universal_media_uz_bot Ğ²Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ ÑĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ:\n\nâ—Instagram - Ğ¿Ğ¾ÑÑ‚Ñ‹, ÑÑ‚Ğ¾Ñ€Ğ¸Ñ, Ñ€Ğ¸Ğ»Ñ;\nâ—YouTube - Ğ²Ğ¸Ğ´ĞµĞ¾, ÑˆĞ¾Ñ€Ñ‚Ñ, Ğ°ÑƒĞ´Ğ¸Ğ¾;\nâ—Tik Tok - Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ±ĞµĞ· Ğ²Ğ¾Ğ´ÑĞ½Ñ‹Ñ… Ğ·Ğ½Ğ°ĞºĞ¾Ğ²;\nâ—Facebook - Ñ€Ğ¸Ğ»Ñ\nâ—VK - Ğ²Ğ¸Ğ´ĞµĞ¾;\nâ—Pinterest - Ñ„Ğ¾Ñ‚Ğ¾, Ğ²Ğ¸Ğ´ĞµĞ¾\nâ—Snapchat - Ñ„Ğ¾Ñ‚Ğ¾, Ğ²Ğ¸Ğ´ĞµĞ¾\nâ—Likee - Ñ„Ğ¾Ñ‚Ğ¾, Ğ²Ğ¸Ğ´ĞµĞ¾\nâ—Threads - Ñ„Ğ¾Ñ‚Ğ¾, Ğ²Ğ¸Ğ´ĞµĞ¾\nâ—Bigo Live - Ğ²Ğ¸Ğ´ĞµĞ¾, ÑÑ„Ğ¸Ñ€\nĞ”Ğ»Ñ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ ÑÑÑ‹Ğ»ĞºÑƒ.",
        'search_searching': "ğŸ”¥ ĞŸĞ¾Ğ¸ÑĞº Ñ‚Ğ¾Ğ¿ Ğ¼ÑƒĞ·Ñ‹ĞºĞ¸ Ğ¿Ğ¾ '{query}'...",
        'search_top_loading': "ğŸ”¥ ĞŸĞ¾Ğ¸ÑĞº Ñ‚Ğ¾Ğ¿ ÑƒĞ·Ğ±ĞµĞºÑĞºĞ¾Ğ¹ Ğ¼ÑƒĞ·Ñ‹ĞºĞ¸...",
        'search_not_found': "Ğ¢Ğ¾Ğ¿ Ğ¼ÑƒĞ·Ñ‹ĞºĞ° Ğ¿Ğ¾ĞºĞ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°.",
        'getting_info': "â³ ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸...",
        'search_music_searching': "ğŸ” ĞŸĞ¾Ğ¸ÑĞº Ğ¼ÑƒĞ·Ñ‹ĞºĞ¸: {query}...",
        'nothing_found': "ĞĞ¸Ñ‡ĞµĞ³Ğ¾ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾ ğŸ˜”",
        'no_favorites': "â¤ï¸ Ğ£ Ğ²Ğ°Ñ Ğ¿Ğ¾ĞºĞ° Ğ½ĞµÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¼ÑƒĞ·Ñ‹ĞºĞ¸.",
        'favorites_header': "â¤ï¸ <b>Ğ˜Ğ·Ğ±Ñ€Ğ°Ğ½Ğ½Ğ°Ñ Ğ¼ÑƒĞ·Ñ‹ĞºĞ°:</b>\n\n",
        'saved': "â¤ï¸ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾!",
        'already_saved': "Ğ£Ğ¶Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚!",
        'saved_msg': "âœ… Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾: {title}",
        'error_no_link': "Ğ¡ÑÑ‹Ğ»ĞºĞ° Ğ´Ğ»Ñ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ°.",
        'error_general': "ĞÑˆĞ¸Ğ±ĞºĞ°: {error}",
        'choose_quality': "â¤ï¸ Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾: {title}\n\nĞ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾:",
        'lang_choose': "ğŸ’¬ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑĞ·Ñ‹Ğº, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ñ…Ğ¾Ñ‚Ğ¸Ñ‚Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ, Ğ¸ Ğ±Ğ¾Ñ‚ Ğ½Ğ°Ñ‡Ğ½ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ½Ğ° Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğ¼ Ğ²Ğ°Ğ¼Ğ¸ ÑĞ·Ñ‹ĞºĞµ.\n\n(Ğ”Ğ»Ñ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° ÑĞ·Ñ‹ĞºĞ° Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ° Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ¾Ğ´Ğ½Ñƒ Ğ¸Ğ· ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº Ğ½Ğ¸Ğ¶Ğµ)",
        'lang_selected': "âœ… Ğ¯Ğ·Ñ‹Ğº Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½: Ğ ÑƒÑÑĞºĞ¸Ğ¹ ğŸ‡·ğŸ‡º",
        'downloading': "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°... 0%",
        'downloading_percent': "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°... {percent} â³",
        'finished_uploading': "Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ¾. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ°... ğŸš€",
        'video_caption': "ğŸµ <b>{title}</b>",
        'video_only_caption': "ğŸµ <b>{title}</b>",
        'btn_video': "ğŸ¬ Ğ’Ğ¸Ğ´ĞµĞ¾",
        'btn_audio': "ğŸ§ MP3",
        'btn_save': "ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ",
        'btn_download_song': "ğŸ“¥ Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¿ĞµÑĞ½Ñ",
        'btn_add_group': "â• Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² Ğ³Ñ€ÑƒĞ¿Ğ¿Ñƒ â¤´ï¸",
        'btn_close': "âŒ Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ",
        'btn_back': "ğŸ”™ ĞĞ°Ğ·Ğ°Ğ´",
        'voice_listening': "ğŸ¤ Ğ¡Ğ»ÑƒÑˆĞ°Ñ Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ...",
        'voice_you_said': "ğŸ—£ Ğ’Ñ‹ ÑĞºĞ°Ğ·Ğ°Ğ»Ğ¸: {text}",
        'voice_error': "ğŸ¤·â€â™‚ï¸ Ğ˜Ğ·Ğ²Ğ¸Ğ½Ğ¸Ñ‚Ğµ, Ñ Ğ½Ğµ Ğ¿Ğ¾Ğ½ÑĞ», Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹ ÑĞºĞ°Ğ·Ğ°Ğ»Ğ¸.",
        'file_too_large': "âš ï¸ Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ñ„Ğ°Ğ¹Ğ»Ğ° ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ ({size} MB). Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ Telegram 50 MB.\nĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ½Ğ¸Ğ¶Ğµ Ğ¸Ğ»Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ Ğ´Ñ€ÑƒĞ³ÑƒÑ ÑÑÑ‹Ğ»ĞºÑƒ.",
        'retry_low_quality': "âš ï¸ Ğ¤Ğ°Ğ¹Ğ» ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹. ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ² Ğ½Ğ¸Ğ·ĞºĞ¾Ğ¼ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğµ ({quality}p)... ğŸ“‰",
        'video_quality_select': "ğŸ¬ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾:",
        'results_title': "ğŸ” Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ ({page}/{total}):\n\n",
        'download_error': "Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ°ÑÑŒ ğŸ˜¢",
        'search_results_expired': "Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ğ¿Ğ¾Ğ¸ÑĞºĞ° ÑƒÑÑ‚Ğ°Ñ€ĞµĞ»Ğ¸.",
        'error_item_not_found': "ĞÑˆĞ¸Ğ±ĞºĞ°: Ğ­Ğ»ĞµĞ¼ĞµĞ½Ñ‚ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½",
        'error_link_expired': "ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ¾ÑˆĞ»Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ°. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ ÑÑÑ‹Ğ»ĞºÑƒ ĞµÑ‰Ğµ Ñ€Ğ°Ğ·.",
        'voice_convert_error': "âš ï¸ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ° Ğ³Ğ¾Ğ»Ğ¾ÑĞ°.\nĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ, ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ğ»Ğ¸ FFmpeg.",
        'voice_google_error': "âš ï¸ ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ»ÑƒĞ¶Ğ±Ñ‹ Google Speech: {error}",
        'menu_tg_anon': "ĞĞ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ğ¾ Ğ² Telegram ğŸ‘€",
        'menu_insta_anon': "ĞĞ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ğ¾ Ğ² Instagram ğŸ‘€",
        'feature_soon': "ğŸ›  Ğ­Ñ‚Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ ÑĞºĞ¾Ñ€Ğ¾ ÑÑ‚Ğ°Ğ½ĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾Ğ¹!",
        'insta_anon_instruction': "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ ÑÑÑ‹Ğ»ĞºÑƒ Ğ½Ğ° Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ² Instagram.",
        'tg_anon_instruction': "Ğ§ÑŒÑ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ² Telegram Ğ²Ñ‹ Ñ…Ğ¾Ñ‚Ğ¸Ñ‚Ğµ Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ğ¾?\nĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ Ğ¸Ğ¼Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ¸Ğ»Ğ¸ ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚.",
        'btn_video_manual': "Ğ’Ğ¸Ğ´ĞµĞ¾ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ ğŸ·",
        'story_menu_today': "ğŸ‘€ ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ·Ğ° ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ",
        'story_menu_old': "ğŸ‘€ ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ÑÑ‚Ğ°Ñ€Ñ‹Ğµ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸",
        'btn_8d': "ğŸ§ 8D",
        'btn_concert': "ğŸŸ Concert Hall",
        'btn_slowed': "ğŸ¢ Slowed",
        'btn_bass': "ğŸ”Š Bass",
        'select_effect': "ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ ğŸ‘‡",
        'recognition_processing': "ğŸ§ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¼ĞµĞ´Ğ¸Ğ°... (Music Recognition)",
        'music_recognized': "ğŸµ <b>ĞœÑƒĞ·Ñ‹ĞºĞ° Ñ€Ğ°ÑĞ¿Ğ¾Ğ·Ğ½Ğ°Ğ½Ğ°!</b>\n\n",
        'music_artist': "ğŸ¤ Ğ˜ÑĞ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒ: <b>{artist}</b>\n",
        'music_title': "ğŸ¼ ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ: <b>{title}</b>\n",
        'music_not_found': "ĞœÑƒĞ·Ñ‹ĞºĞ° Ğ½Ğµ Ñ€Ğ°ÑĞ¿Ğ¾Ğ·Ğ½Ğ°Ğ½Ğ° (No music found).",
        'music_fallback_search': "âš ï¸ ĞœÑƒĞ·Ñ‹ĞºĞ° Ğ½Ğµ Ñ€Ğ°ÑĞ¿Ğ¾Ğ·Ğ½Ğ°Ğ½Ğ°. ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ Ğ¸Ğ¼ĞµĞ½Ğ¸ Ñ„Ğ°Ğ¹Ğ»Ğ°: {query}",
        'music_fallback_failed': "ĞœÑƒĞ·Ñ‹ĞºĞ° Ğ½Ğµ Ñ€Ğ°ÑĞ¿Ğ¾Ğ·Ğ½Ğ°Ğ½Ğ° Ğ¸ Ğ¿Ğ¾Ğ¸ÑĞº Ğ½Ğµ Ğ´Ğ°Ğ» Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ².",
        'btn_more_links': "Ğ‘Ğ¾Ğ»ÑŒÑˆĞµ ÑÑÑ‹Ğ»Ğ¾Ğº ğŸ”—",
        'btn_telegram_search': "ğŸ“¥ Telegram",
        'top_menu_text': "ğŸµ <b>Ğ¢Ğ¾Ğ¿ ĞœÑƒĞ·Ñ‹ĞºĞ°</b>\n\nĞšĞ°ĞºÑƒÑ Ğ¼ÑƒĞ·Ñ‹ĞºÑƒ Ğ²Ñ‹ Ğ¸Ñ‰ĞµÑ‚Ğµ?",
        'cat_uz': "ğŸ‡ºğŸ‡¿ Ğ£Ğ·Ğ±ĞµĞºÑĞºĞ¸Ğµ Ğ¥Ğ¸Ñ‚Ñ‹",
        'cat_world': "ğŸŒ ĞœĞ¸Ñ€Ğ¾Ğ²Ñ‹Ğµ Ğ¥Ğ¸Ñ‚Ñ‹",
        'cat_trend': "ğŸ”¥ Ğ¢Ñ€ĞµĞ½Ğ´ (TikTok/Reels)",
        'cat_new': "ğŸ†• ĞĞ¾Ğ²Ğ¸Ğ½ĞºĞ¸",
        'cat_bass': "ğŸ”Š Bass / ĞĞ²Ñ‚Ğ¾",
        'btn_find_music': "ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ Ğ¼ÑƒĞ·Ñ‹ĞºÑƒ ğŸ”",
        'download_formats': "Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ñ‹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ â†“"
    },
    'en': {
        'start_welcome': "Welcome to Universal Media Bot\n\nYou can download from:\n\nâ—Instagram - posts, stories, reels;\nâ—YouTube - videos, shorts, audio;\nâ—Tik Tok - no watermark;\nâ—Facebook - reels\nâ—VK - videos;\nâ—Pinterest - photos, videos\nâ—Snapchat - photos, videos\nâ—Likee - photos, videos\nâ—Threads - photos, videos\nâ—Bigo Live - videos, lives\nSend a link to start downloading.",
        'search_searching': "ğŸ”¥ Searching top music for '{query}'...",
        'search_top_loading': "ğŸ”¥ Searching top Uzbek music hits...",
        'search_not_found': "No top music found yet.",
        'getting_info': "â³ Fetching info...",
        'search_music_searching': "ğŸ” Searching music: {query}...",
        'nothing_found': "Nothing found ğŸ˜”",
        'no_favorites': "â¤ï¸ You don't have any saved music yet.",
        'favorites_header': "â¤ï¸ <b>Favorite Music:</b>\n\n",
        'saved': "â¤ï¸ Saved!",
        'already_saved': "Already exists!",
        'saved_msg': "âœ… Saved: {title}",
        'error_no_link': "No link found to save.",
        'error_general': "Error: {error}",
        'choose_quality': "â¤ï¸ Selected: {title}\n\nSelect quality:",
        'lang_choose': "ğŸ’¬ Select the language you want to use, and the bot will start working in your chosen language.\n\n(Click one of the buttons below to select the interface language)",
        'lang_selected': "âœ… Language changed: English ğŸ‡ºğŸ‡¸",
        'downloading': "Downloading... 0%",
        'downloading_percent': "Downloading... {percent} â³",
        'finished_uploading': "Downloaded. Uploading... ğŸš€",
        'video_caption': "ğŸµ <b>{title}</b>",
        'video_only_caption': "ğŸµ <b>{title}</b>",
        'btn_video': "ğŸ¬ Video",
        'btn_audio': "ğŸ§ MP3",
        'btn_save': "ğŸ’¾ Save",
        'btn_download_song': "ğŸ“¥ Download Song",
        'btn_add_group': "â• Add to Group â¤´ï¸",
        'btn_close': "âŒ Close",
        'btn_back': "ğŸ”™ Back",
        'voice_listening': "ğŸ¤ Listening to voice message...",
        'voice_you_said': "ğŸ—£ You said: {text}",
        'voice_error': "ğŸ¤·â€â™‚ï¸ Sorry, I didn't understand what you said.",
        'file_too_large': "âš ï¸ File size too large ({size} MB). Telegram Limit 50 MB.\nPlease select lower quality or send another link.",
        'retry_low_quality': "âš ï¸ File too large. Retrying lower quality ({quality}p)... ğŸ“‰",
        'video_quality_select': "ğŸ¬ Select video quality:",
        'results_title': "ğŸ” Results ({page}/{total}):\n\n",
        'download_error': "Download failed ğŸ˜¢",
        'search_results_expired': "Search results expired.",
        'error_item_not_found': "Error: Item not found",
        'error_link_expired': "Error occurred. Please send the link again.",
        'voice_convert_error': "âš ï¸ Error converting voice format.\nCheck if FFmpeg is installed.",
        'voice_google_error': "âš ï¸ Google Speech service error: {error}",
        'menu_tg_anon': "Anonymous in Telegram ğŸ‘€",
        'menu_insta_anon': "Anonymous in Instagram ğŸ‘€",
        'feature_soon': "ğŸ›  This feature will be available soon!",
        'insta_anon_instruction': "Send Instagram story link.",
        'tg_anon_instruction': "Whose Telegram story do you want to view anonymously?\nSend username or contact.",
        'btn_video_manual': "Video Guide ğŸ·",
        'story_menu_today': "ğŸ‘€ View Today's Stories",
        'story_menu_old': "ğŸ‘€ View Old Stories",
        'btn_8d': "ğŸ§ 8D",
        'btn_concert': "ğŸŸ Concert Hall",
        'btn_slowed': "ğŸ¢ Slowed",
        'btn_bass': "ğŸ”Š Bass",
        'select_effect': "Please select the desired option ğŸ‘‡",
        'recognition_processing': "ğŸ§ Analyzing media... (Music Recognition)",
        'music_recognized': "ğŸµ <b>Music Recognized!</b>\n\n",
        'music_artist': "ğŸ¤ Artist: <b>{artist}</b>\n",
        'music_title': "ğŸ¼ Title: <b>{title}</b>\n",
        'music_not_found': "No music found.",
        'music_fallback_search': "âš ï¸ Music not confirmed. Searching by filename: {query}",
        'music_fallback_failed': "Music not recognized and search returned no results.",
        'btn_more_links': "More Links ğŸ”—",
        'btn_telegram_search': "ğŸ“¥ Telegram",
        'top_menu_text': "ğŸµ <b>Top Music Menu</b>\n\nWhat kind of music are you looking for?",
        'cat_uz': "ğŸ‡ºğŸ‡¿ Uzbek Hits",
        'cat_world': "ğŸŒ World Hits",
        'cat_trend': "ğŸ”¥ Trending (TikTok)",
        'cat_new': "ğŸ†• New Releases",
        'cat_bass': "ğŸ”Š Bass / Car",
        'btn_find_music': "Find Music ğŸ”",
        'download_formats': "Download formats â†“"
    }
}

def load_user_language(chat_id):
    if not os.path.exists(LANGUAGES_FILE):
        return 'uz'
    try:
        with open(LANGUAGES_FILE, 'r') as f:
            data = json.load(f)
            return data.get(str(chat_id), 'uz')
    except:
        return 'uz'

def save_user_language(chat_id, lang_code):
    data = {}
    if os.path.exists(LANGUAGES_FILE):
        try:
             with open(LANGUAGES_FILE, 'r') as f:
                 data = json.load(f)
        except:
             pass
    
    data[str(chat_id)] = lang_code
    
    with open(LANGUAGES_FILE, 'w') as f:
        json.dump(data, f)

def get_text(chat_id, key, format_args=None):
    lang = load_user_language(chat_id)
    text = MESSAGES.get(lang, MESSAGES['uz']).get(key, MESSAGES['uz'].get(key, key))
    if format_args:
        try:
             return text.format(**format_args)
        except:
             return text
    return text
